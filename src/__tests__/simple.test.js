import { createCanvas, loadImage } from 'canvas';

import { drawArbitraryQuadImage, FILL_METHOD } from '../index';

const mockedImage = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAABmJLR0QA/wD/AP+gvaeTAAAWLUlEQVR4nO3deXhU1f3H8XekEAiJZIFSmYBABAQjIkgRioDWYPuz1LogVq1VW7UudQGEsAQCpEAEw2IIBAiRACGAFJHWBw0u4IZiXXGtuMFoLeKCMhOWeH5/XG86hIQszMyd5fN6Hp7aZHLnzJ35fuacc+89F0REREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREREROXBOnGyCO+RmwBegKvAxUONscEQmGRGAGYKr9mw0kOdguEQmgowo/ISHBxMTEmJiYGJOQkOAbBPehIBCJGEcV/tChQ83GjRvN7NmzTUJCgmnVqpXJz88369evN0OGDKkeBIkOtltETsAxhb9582ZjjDEVFRVm1qxZVQGwYMECc/DgQWOMMRs3bjSDBg3yDYKpQIKDr0NEGqAttRS+raKiwuTm5pr4+HiTmJhoCgoKqgLAtmHDBjNw4EDfIMj+cdsiEoJ6Ajs4TuH7BsDMmTOrAmDhwoXm0KFDNT52/fr1ZsCAAb5B8A4KApGQkQjkUY/Ct3m9XjNjxoyqACgsLKw1AGzr1q0z/fv39w2CLCDewdctEtVqHePXxev1munTp5uWLVuapKQks3jx4joDwLZ27VrTr1+/6kHQ0sH9IBJVGl34/ggAW1lZmenbt68dAj8AY4A4B/eLSEQ74cL3DYCcnJyqAFi6dGmDA8BWWlpq+vTp4xsE96IgEPEbvxW+bwBMmzbNxMXFmaSkJFNUVNToALCtXLnS9O7d2zcIRgEtHNxvImGtC/Asfix83wCYOnWqiYuLM8nJyWbZsmUnHAC2kpIS06tXL98geBEdNRCpt0TgTQJQ+Dav12uys7OrAqC4uNgcPnzYr8+xfPly07Nnz+rnEcQ6t1tFQpvfu/q18Xq9ZvLkyaZFixYmOTnZPPjgg34PAFtxcbFJT0+3Q6ASuA0FgUiVoBW+rXoALF++PGABYCsqKjI9evTwDYJbgWYO7ncRRwW98G0ej8dMmjTJtGjRwqSkpJiS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';

const canvas = createCanvas(256, 256);
const ctx = canvas.getContext('2d');

const srcPoints = [
  { x: 0, y: 0 },
  { x: 0, y: 255 },
  { x: 255, y: 255 },
  { x: 255, y: 0 },
];

const dstPoints = [
  { x: 128, y: 64 },
  { x: 255, y: 128 },
  { x: 128, y: 192 },
  { x: 0, y: 128 },
];

describe('bilinear simple test', () => {
  it('Should transform image correctly', done => {
    loadImage(`${__dirname}/quad.jpg`).then(image => {
      drawArbitraryQuadImage(ctx, image, srcPoints, dstPoints, FILL_METHOD.BILINEAR);

      expect(canvas.toDataURL()).toEqual(mockedImage);
      done();
    });
  });
});
